--source include/have_innodb.inc

--echo #
--echo # Testing analyze table behaviour 
--echo #

--echo #
CREATE TABLE Table1 (
 `LastName` VARCHAR(20),
 `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT, 
 `FirstName` VARCHAR(20),
 `PetAge` INT UNSIGNED, 
 `PetName` VARCHAR(20),
 `NumberOfPuppies` INT UNSIGNED,
 PRIMARY KEY (`ID`),
 UNIQUE KEY (`PetName`)
) Engine=InnoDB;

--echo #
--echo # Table values
INSERT INTO Table1 (PetName, LastName, FirstName, PetAge, NumberOfPuppies) VALUES
("Phrom", "Uttlyea", "Chshkouts", 248, 169),
("Gationatia", "Gatess", "Camo", 118, 224),
("Isfincelicur", "Sinchacoperspi", "Usementschaini", 124, 47),
("Aningsss", "Puriever", "Essentradped", 165, 172),
("Acro", "Prograte", "Uggl", 37, 87),
("Banicrushwi", "Arubionfudel", "Raneduslyt", 187, 128),
("Acri", "Rtinse", "Ngyster", 21, 12),
("Ariestastuarna", "Libill", "Vestenmatio", 185, 238),
("Pindomestarcudin", "Apeliapedscaser", "Borge", 69, 139),
("Imentivapp", "Untionangranagel", "Exallutssnolour", 243, 29),
("Surintardeachfor", "Acherentante", "Endeningsss", 155, 181),
("Alicristansil", "Tertspoosit", "Ccellonsupss", 194, 199),
("Nompassi", "Suliessibblere", "Adectrawson", 44, 25),
("Deje", "Relyes", "Rochardsterwapp", 183, 35),
("Argla", "Tatroudierumi", "Nuouch", 247, 178),
("Tancestasti", "Ncencheekined", "Ershotchm", 61, 35),
("Udgm", "Osepangern", "Whooperept", 212, 199),
("Hortbe", "Istswetallessse", "Ionasseborenemo", 234, 183),
("Tiontssaurai", "Aracollusssitta", "Adightchecons", 19, 73),
("Itslyw", "Lachlegrassers", "Ersepi", 72, 10),
("Elifigiencesoci", "Nnysimsedsollead", "Barsi", 33, 158);

set histogram_size=1;
set histogram_type='SINGLE_PREC_HB';

ANALYZE FAST TABLE Table1 PERSISTENT FOR COLUMNS (PetAge, NumberOfPuppies);

select min_value, max_value, hist_type, hex(histogram), decode_histogram(hist_type, histogram)
from mysql.column_stats where table_name='Table1';

SHOW INDEXES FROM Table1;

DROP TABLE Table1;
