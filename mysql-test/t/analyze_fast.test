--echo #
--echo # Test for ANALYZE FAST ... PERSISTENT FOR COLUMNS (...) 
--echo #

DROP TABLE IF EXISTS Table1;

CREATE TABLE Table1 (
 PetName varchar(20),
 LastName varchar(20),
 FirstName varchar(20)
);

INSERT INTO Table1 VALUES ("Flufy", "Yates", "Maria");
INSERT INTO Table1 VALUES ("Buttons", "David", "Jones");
INSERT INTO Table1 VALUES ("Paws", "Johanson", "Samuel");
SELECT * FROM Table1;

ANALYZE FAST TABLE Table1 PERSISTENT FOR COLUMNS (PetName);

--error ER_POSITIVE_NUMBER
ANALYZE FAST TABLE Table1 WITH 0 ROWS PERSISTENT FOR COLUMNS (LastName);

--error ER_POSITIVE_NUMBER
ANALYZE FAST TABLE Table1 SAMPLING 0 PERCENT PERSISTENT FOR COLUMNS (LastName);

--error ER_POSITIVE_NUMBER
ANALYZE FAST TABLE Table1 LASTS 0 SECONDS PERSISTENT FOR COLUMNS (LastName);

--error ER_POSITIVE_NUMBER
ANALYZE FAST TABLE Table1 PERSISTENT FOR COLUMNS (LastName IN RANGE 0);

DROP TABLE Table1;
